<h1>Posts#edit</h1>
<%= stylesheet_link_tag 'my_places' %>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" />
<span>現在ログイン中のユーザー：<%= current_user.name %></span>
<%= form_with model: @place,url: my_place_path, local: true do |f| %>
    <div>
        <%= f.label :中身 %><br>
        <%= f.text_area :comment %>
        <%= f.label :中身 %><br>
        <div class="main-rating">
          <div class="ratings ratings mb-3">
            <span class="fa fa-star-o" id="star"></span>
            <span class="fa fa-star-o" id="star"></span>
            <span class="fa fa-star-o" id="star"></span>
            <span class="fa fa-star-o" id="star"></span>
            <span class="fa fa-star-o" id="star"></span>
          </div>
          <div class="ml-3 rating-value-display"><span id="rating-value-display">0</span>/5</div>
        </div>
        <%= f.text_field :rate, id: "rating-value"%>

        <!--評価js-->
        <script>
          const stars = document.querySelector(".ratings").children;
          const ratingValue = document.getElementById("rating-value");
          const ratingValueDisplay = document.getElementById("rating-value-display");
          let index;

          for(let i=0; i<stars.length; i++){
            stars[i].addEventListener("mouseover", function(){
              for(let j=0; j<stars.length; j++){
                stars[j].classList.remove("fa-star");
                stars[j].classList.add("fa-star-o");
              }
              for(let j=0; j<=i; j++){
                stars[j].classList.remove("fa-star-o");
                stars[j].classList.add("fa-star");
              }
            })

            stars[i].addEventListener("click", function(){
              ratingValue.value = i + 1;
              ratingValueDisplay.textContent = ratingValue.value;
              index = i;
            })

            stars[i].addEventListener("mouseout", function(){
              for(let j=0; j<stars.length; j++){
                stars[j].classList.remove("fa-star");
                stars[j].classList.add("fa-star-o");
              }
              for(let j=0; j<=index; j++){
                stars[j].classList.remove("fa-star-o");
                stars[j].classList.add("fa-star");
              }
            })
          }
        </script>
    </div>
    <div><%= f.submit "更新する" %></div>
<% end %>
